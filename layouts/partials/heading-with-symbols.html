{{- /* layouts/partials/heading-with-symbols.html */ -}}
{{- /*
  Context (.) expected:
  - level: Heading level (int 1-6)
  - anchor: ID for the heading (string)
  - text: Inner HTML content for the heading (string, must be safeHTML)
  - page: The current page object (needed for .Scratch)
*/ -}}

{{- $level := .level | default 2 -}}
{{- $anchor := .anchor | default (.text | plainify | urlize) -}}
{{- $text := .text | safeHTML -}}
{{- $page := .page -}}

{{- /* Define the list of symbols - Ensure this matches the one in render-heading.html if kept */ -}}
{{- $symbols := slice "ð“†™" "ðŸŒ€" "ð“‚€" "â–³" "ð“‹¹" "ð“‡³" "âš•" "âœ¡" "ðŸª¬" "ÖŽ" "âˆž" "â–²" "ð“†“" "ð“‚“" -}}
{{- $numSymbols := len $symbols -}}

{{- /* Initialize or increment heading counter for the page */ -}}
{{- $headingIndex := $page.Scratch.Get "headingCounter" | default 0 -}}
{{- $page.Scratch.Set "headingCounter" (add $headingIndex 1) -}}

{{- /* Get the current symbol based on the counter */ -}}
{{- $symbolIndex := mod $headingIndex $numSymbols -}}
{{- $currentSymbol := index $symbols $symbolIndex -}}

{{- /* Set CSS variables for the ::before and ::after content */ -}}
{{- $style := printf `--symbol-before: '%s '; --symbol-after: ' %s';` $currentSymbol $currentSymbol | safeCSS -}}

{{- /* Output the heading element */ -}}
<h{{ $level }} id="{{ $anchor }}" style="{{ $style }}">{{ $text }}</h{{ $level }}> 